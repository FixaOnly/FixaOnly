<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Chat Keren</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

    <!-- View 1: Login / Onboarding -->
    <div id="loginView" class="view active">
        <div class="form-container">
            <h1><i class="fas fa-comments"></i> Fixa Chat 0.2</h1>
            <p>Masuk dengan Nama dan ID Privasi Anda</p>
            <form id="loginForm">
                <input type="text" id="nameInput" placeholder="Nama Anda" required>
                <div class="password-container">
                    <input type="password" id="privacyIdInput" placeholder="ID Privasi Anda" required>
                    <button type="button" class="toggle-visibility-btn" onclick="toggleInputVisibility('privacyIdInput', this)">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <button type="submit"><i class="fas fa-sign-in-alt"></i> Masuk</button>
            </form>
            <p class="form-footer" onclick="showCreateAccountModal()">Belum punya akun? Buat Baru</p>
        </div>
    </div>

    <!-- View 2: Menu Utama (Setelah Login) -->
    <div id="mainView" class="view">
        <header>
            <h1><i class="fas fa-comments"></i> Fixa Chat 0.2</h1>
            <div class="user-info">
                <div>
                    <span id="displayName"></span>
                    <div class="id-container">
                        <span id="displayUserId" class="id-display"></span>
                        <button onclick="copyToClipboard(currentUser.id)" title="Salin ID"><i class="fas fa-copy"></i></button>
                        <button onclick="shareId(currentUser.id)" title="Bagikan ID"><i class="fas fa-share"></i></button>
                    </div>
                </div>
                <div class="password-container privacy-id-container">
                    <span id="displayPrivacyId" class="id-display"></span>
                    <button type="button" class="toggle-visibility-btn" onclick="toggleSpanVisibility('displayPrivacyId', this)">
                        <i class="fas fa-eye-slash"></i>
                    </button>
                </div>
            </div>
        </header>
        <main class="menu-grid">
            <button onclick="showCreateGroupModal()"><i class="fas fa-plus-square"></i> Buat Grup Baru</button>
            <button onclick="showJoinGroupModal()"><i class="fas fa-sign-in-alt"></i> Gabung Grup</button>
            <button onclick="showAddFriendModal()"><i class="fas fa-user-plus"></i> Tambah Teman</button>
            <button onclick="showFriendsList()"><i class="fas fa-user-friends"></i> Daftar Teman</button>
            <button onclick="showOnlineUsersModal()"><i class="fas fa-globe"></i> User Online</button>
            <button onclick="showBlockedUsersModal()"><i class="fas fa-ban"></i> Daftar Blokir</button>
            <button onclick="showContactView()"><i class="fas fa-envelope"></i> Hubungi Developer</button>
            <button onclick="logout()"><i class="fas fa-sign-out-alt"></i> Keluar</button>
        </main>
    </div>

    <!-- View 3, 4, 5, Modal, dan Notifikasi tetap sama -->
    <!-- ... -->
    <div id="groupChatView" class="view chat-view">
        <header>
            <button class="back-btn" onclick="backToMain()"><i class="fas fa-arrow-left"></i></button>
            <div class="header-info">
                <h2 id="groupChatTitle"></h2>
                <span id="displayGroupId" class="id-display"></span>
            </div>
            <div class="header-actions">
                <button onclick="showInviteFriendsModal()" title="Undang Teman"><i class="fas fa-user-plus"></i></button>
                <button onclick="showGroupMembers()" title="Daftar Anggota"><i class="fas fa-users"></i></button>
            </div>
        </header>
        <main id="groupMessagesContainer" class="messages-container"></main>
        <footer class="message-input-container">
            <form id="groupMessageForm">
                <input type="text" id="groupMessageInput" placeholder="Ketik pesan..." autocomplete="off">
                <button type="submit"><i class="fas fa-paper-plane"></i></button>
            </form>
        </footer>
    </div>
    
    <div id="privateChatView" class="view chat-view">
        <header>
            <button class="back-btn" onclick="backToMain()"><i class="fas fa-arrow-left"></i></button>
            <h2 id="privateChatTitle"></h2>
            <button onclick="showPrivateChatOptions()" title="Opsi"><i class="fas fa-ellipsis-v"></i></button>
        </header>
        <main id="privateMessagesContainer" class="messages-container"></main>
        <footer class="message-input-container">
            <form id="privateMessageForm">
                <input type="text" id="privateMessageInput" placeholder="Ketik pesan..." autocomplete="off">
                <button type="submit"><i class="fas fa-paper-plane"></i></button>
            </form>
        </footer>
    </div>

    <div id="contactView" class="view">
        <header>
            <button class="back-btn" onclick="backToMain()"><i class="fas fa-arrow-left"></i></button>
            <h1>Hubungi Developer</h1>
        </header>
        <main class="contact-list">
            <a href="https://wa.me/6283125053696" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
            <a href="https://instagram.com/fixaxiterz" target="_blank"><i class="fab fa-instagram"></i> Instagram</a>
            <a href="https://t.me/FixaOnly" target="_blank"><i class="fab fa-telegram"></i> Telegram</a>
            <a href="mailto:fixateamreal@gmail.com"><i class="fas fa-envelope"></i> Email</a>
        </main>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="script.js"></script>
</body>
</html>